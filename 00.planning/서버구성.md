# ì„œë²„ êµ¬ì„±

## ì„œë²„ ì‚¬ì–‘

A : 192.168.40.61

B : 192.168.40.62

C : 192.168.40.54

## ì„œë²„ì‚¬ì–‘

3ê°œì˜ ì„œë²„ê°€ ëª¨ë‘ ë™ì¼ ì‚¬ì–‘

í”„ë¡œì„¸ì„œ : AMD Ryzen 5 PRO 4650G with Radeon Graphics   3.70 GHz
ì„¤ì¹˜ëœ : RAM 32.0GB
ì €ì¥ì†Œ : 466 GB SSD Samsung SSD 970 EVO 500GB
ê·¸ë˜í”½ ì¹´ë“œ : NVIDIA GeForce GTX 1660 SUPER (6 GB)
ì‹œìŠ¤í…œ ì¢…ë¥˜ : 64ë¹„íŠ¸ ìš´ì˜ ì²´ì œ, x64 ê¸°ë°˜ í”„ë¡œì„¸ì„œ

## ì„œë²„ ì´ë¦„

### ** ì•„ë¦¬ìŠ¤í† í…”ë ˆìŠ¤ì˜ ìˆ˜ì‚¬í•™: ì„¤ë“ì˜ 3ìš”ì†Œ**

ë©´ì ‘ì´ë¼ëŠ” ê³¼ì •ì´ ê²°êµ­ 'ë‚˜ë¥¼ ì¦ëª…í•˜ê³  ì„¤ë“í•˜ëŠ” ê³¼ì •'ì„ì„ ì€ìœ í–ˆìŠµë‹ˆë‹¤.

* **A ì„œë²„ (ëŒ€í™”) â†’Logos(ë¡œê³ ìŠ¤)**

  * **ì˜ë¯¸:** **ë§, ì–¸ì–´, ë…¼ë¦¬**ë¥¼ ëœ»í•©ë‹ˆë‹¤.
  * **ì´ìœ :** ì‹¤ì‹œê°„ìœ¼ë¡œ ë…¼ë¦¬ì ì¸ ëŒ€í™”ê°€ ì˜¤ê°€ëŠ” ì¸í„°í˜ì´ìŠ¤ ë¶€ë¶„ì…ë‹ˆë‹¤. ë©´ì ‘ì˜ 'ë‚´ìš©'ê³¼ 'íë¦„'ì„ ë‹´ë‹¹í•©ë‹ˆë‹¤.
* **B ì„œë²„ (íƒœë„) â†’Pathos(íŒŒí† ìŠ¤)**

  * **ì˜ë¯¸:** **ê°ì •, ê³µê°, ì •ì„œì  í˜¸ì†Œ**ë¥¼ ëœ»í•©ë‹ˆë‹¤.
  * **ì´ìœ :** í…ìŠ¤íŠ¸ ë„ˆë¨¸ì˜ ë¹„ì–¸ì–´ì  ìš”ì†Œ(í‘œì •, ë¶„ìœ„ê¸°)ë¥¼ ì½ì–´ë‚´ê³  ë¶„ì„í•˜ëŠ” ê°ì„±ì /ì§ê´€ì  ë¶„ì„ ì˜ì—­ì…ë‹ˆë‹¤.
* **C ì„œë²„ (ê·¼ê±°) â†’Ethos(ì—í† ìŠ¤)**

  * **ì˜ë¯¸:** **ì‹ ë¢°ì„±, ì¸ê²©, ê³ ìœ í•œ ì„±í’ˆ**ì„ ëœ»í•©ë‹ˆë‹¤.
  * **ì´ìœ :** ë³€í•˜ì§€ ì•ŠëŠ” ë°ì´í„°ì™€ ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ê¸°ë¡ë“¤ì´ ëª¨ì—¬ ì‹œìŠ¤í…œì˜ ê¶Œìœ„ì™€ ì‹ ë¢°(Source of Truth)ë¥¼ í˜•ì„±í•©ë‹ˆë‹¤.

# ai êµ¬ì„± ì¶”ì²œ

ë™ì¼í•œ ì‚¬ì–‘ì˜ ì„œë²„ 3ëŒ€(**$192.168.40.61, 62, 54$**)ë¥¼ í™œìš©í•˜ì—¬ **GTX 1660 SUPER(6GB VRAM)**ì˜ í•œê³„ë¥¼ ê·¹ë³µí•˜ê³ , ìš”ì²­í•˜ì‹  ëª¨ë“  ê¸°ëŠ¥(STT, TTS, ì‹œê° ì§€ëŠ¥, LLM ë¶„ì„, ë°°ì¹˜)ì„ ì•ˆì •ì ìœ¼ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ë‘ ê°€ì§€ ì•„í‚¤í…ì²˜ë¥¼ ì œì•ˆí•©ë‹ˆë‹¤.

---

## ì¶”ì²œ 1: ì—­í•  ê¸°ë°˜ ê³„ì¸µí˜• êµ¬ì„± (ì•ˆì •ì„± ë° ë³´ì•ˆ ì¤‘ì‹¬)

ì´ êµ¬ì„±ì€ **ì›¹ ì„œë¹„ìŠ¤, AI ëª¨ë¸, ë°ì´í„° ì €ì¥ì†Œ**ë¥¼ ì™„ì „íˆ ë¶„ë¦¬í•˜ì—¬ ìì› ê°„ ê°„ì„­ì„ ì°¨ë‹¨í•©ë‹ˆë‹¤. ê´€ë¦¬ê°€ ìš©ì´í•˜ê³  íŠ¹ì • ì„œë²„ ì¥ì•  ì‹œ ì›ì¸ íŒŒì•…ì´ ë¹ ë¦…ë‹ˆë‹¤.

### 1) ì„œë²„ë³„ ë°°ì¹˜ êµ¬ì¡°

| **ì„œë²„**    | **ì—­í• **         | **ë°°ì¹˜ ì„œë¹„ìŠ¤**                        | **ìì› í™œìš© í¬ì¸íŠ¸**                         |
| ----------------- | ---------------------- | -------------------------------------------- | -------------------------------------------------- |
| **A (.61)** | **Web & Queue**  | FastAPI, Redis, Celery Beat, Dashboard API   | ì‚¬ìš©ì ì ‘ì† ë° ë©”ì‹œì§€ ë¸Œë¡œì»¤ ì „ë‹´                  |
| **B (.62)** | **AI Engine**    | STT, TTS, ì–¼êµ´ ì¸ì‹/í‘œì • ê°ì§€, LLM(ê¼¬ë¦¬ì§ˆë¬¸) | **GPU(6GB) ì „ìš© ì‚¬ìš©** , ëª¨ë“  ëª¨ë¸ ì¶”ë¡  ì „ë‹´ |
| **C (.54)** | **Data & Batch** | PostgreSQL(pgvector), Oracle, ë°°ì¹˜ í”„ë¡œê·¸ë¨  | DB íŠ¸ëœì­ì…˜ ë° ëŒ€ëŸ‰ ë°ì´í„° ìˆ˜ì§‘(Batch) ì „ë‹´        |

### 2) í•µì‹¬ Docker Compose ì„¤ì • (ì„œë²„ B: AI Engine ì˜ˆì‹œ)

ì„œë²„ BëŠ” GPU ìì›ì„ ìµœëŒ€í•œ í™œìš©í•˜ë„ë¡ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.

**YAML**

```
# Server B (192.168.40.62) docker-compose.yml
version: '3.8'
services:
  ai_worker:
    build: ./worker
    container_name: interview_ai_worker
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]
    environment:
      - REDIS_URL=redis://192.168.40.61:6379/0
      - DB_URL=postgresql://admin:pass@192.168.40.54:5432/interview
    command: celery -A tasks worker --loglevel=info -Q ai_tasks --concurrency=1
```

---

## ì¶”ì²œ 2: ë¶€í•˜ ë¶„ì‚° í´ëŸ¬ìŠ¤í„°í˜• êµ¬ì„± (ì²˜ë¦¬ëŸ‰ ë° ì„±ëŠ¥ ì¤‘ì‹¬)

ê°€ì¥ ë¶€í•˜ê°€ í° **AI ì¶”ë¡ (GPU)**ì„ ë‘ ëŒ€ì˜ ì„œë²„ì— ë‚˜ëˆ„ì–´ ë°°ì¹˜í•˜ì—¬, ì‹¤ì‹œê°„ ë©´ì ‘ ì¸ì› ìˆ˜ìš©ëŸ‰ì„ ê·¹ëŒ€í™”í•˜ëŠ” êµ¬ì„±ì…ë‹ˆë‹¤.

### 1) ì„œë²„ë³„ ë°°ì¹˜ êµ¬ì¡°

| **ì„œë²„**    | **ì—­í• **              | **ë°°ì¹˜ ì„œë¹„ìŠ¤**                                     | **ìì› í™œìš© í¬ì¸íŠ¸**                |
| ----------------- | --------------------------- | --------------------------------------------------------- | ----------------------------------------- |
| **A (.61)** | **Real-time AI Node** | FastAPI, STT, LLM(ì‹¤ì‹œê°„ ëŒ€í™”), Redis                     | ì‹¤ì‹œê°„ ë©´ì ‘ ëŒ€í™” ë° ì‚¬ìš©ì ì ‘ì  ë‹´ë‹¹      |
| **B (.62)** | **Vision & Analysis** | ì–¼êµ´ ì¸ì‹, í‘œì • ê°ì§€, ì´ë ¥ì„œ ë¶„ì„, ë°°ì¹˜                   | ì‹œê° ì •ë³´ ë¶„ì„ ë° ë¬´ê±°ìš´ ë¹„ë™ê¸° ë¶„ì„ ë‹´ë‹¹ |
| **C (.54)** | **Central Data**      | PostgreSQL, Oracle, Dashboard Backend, ì„ë² ë”©ëª¨ë¸, ã…“ë°°ì¹˜ | ëª¨ë“  ì„œë¹„ìŠ¤ì˜ ë°ì´í„°ë¥¼ í†µí•© ê´€ë¦¬          |

### 2) íŠ¹ì§• ë° ì¥ì 

* **ìì› ìµœì í™”** : ì„œë²„ AëŠ” ì‹¤ì‹œê°„ì„±(ìŒì„±/ëŒ€í™”)ì— ì§‘ì¤‘í•˜ê³ , ì„œë²„ BëŠ” ë¶„ì„ì„±(ì–¼êµ´/ì´ë ¥ì„œ/ë°°ì¹˜)ì— ì§‘ì¤‘í•˜ì—¬ GPU ë¶€í•˜ë¥¼ ë¶„ì‚°í•©ë‹ˆë‹¤.
* **ë°°ì¹˜ ì•ˆì •ì„±** : ì„œë²„ Bì—ì„œ ëŒì•„ê°€ëŠ” ë°°ì¹˜ í”„ë¡œê·¸ë¨ì´ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ì—¬ ì„œë²„ Cì˜ Oracle/Postgresì— ì ì¬í•˜ë¯€ë¡œ ë°ì´í„° ê°€ìš©ì„±ì´ ë†’ìŠµë‹ˆë‹¤.

---

## ì£¼ìš” ê¸°ëŠ¥ êµ¬í˜„ ë° í˜¸í™˜ì„± ê°€ì´ë“œ

### â‘  ëª¨ë¸ ë° ë¼ì´ë¸ŒëŸ¬ë¦¬ (requirements.txt)

6GB VRAM í™˜ê²½ì—ì„œ ëª¨ë“  ëª¨ë¸ì„ êµ¬ë™í•˜ê¸° ìœ„í•œ í•µì‹¬ ì¡°í•©ì…ë‹ˆë‹¤.

**Plaintext**

```
# AI Frameworks
torch==2.3.1+cu121
faster-whisper==1.0.3  # STT
edge-tts==6.1.12       # TTS (CPU ì‚¬ìš© ê¶Œì¥)
opencv-python          # ì–¼êµ´ ì¸ì‹
deepface               # í‘œì • ê°ì§€ (ê²½ëŸ‰í™” ëª¨ë¸ ì‚¬ìš©)

# LLM & Vector DB
langchain==0.2.14
ollama                 # Llama-3.1 8B (4-bit ì–‘ìí™”)
psycopg2-binary        # PostgreSQL
cx_Oracle              # Oracle ì—°ë™

# Async Task
celery==5.4.0
redis==5.0.8
```

### â‘¡ ê¸°ëŠ¥ë³„ ìƒì„¸ ê°€ì´ë“œ

* **ì–¼êµ´ ë° í‘œì • ê°ì§€** : `DeepFace` ë˜ëŠ” `MediaPipe`ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. ì‹¤ì‹œê°„ ì ìˆ˜ ë°˜ì˜ì„ ìœ„í•´ 1ì´ˆë‹¹ 1~2í”„ë ˆì„ë§Œ ë¶„ì„í•˜ì—¬ GPU ë¶€í•˜ë¥¼ ì¤„ì…ë‹ˆë‹¤.
* **ì´ë ¥ì„œ ë¶„ì„/ì²¨ì‚­** : PDF ì¶”ì¶œì€ `PyMuPDF`ë¥¼ ì‚¬ìš©í•˜ê³ , LLMì— ë„˜ê²¨ JSONìœ¼ë¡œ êµ¬ì¡°í™”í•©ë‹ˆë‹¤. (ì„œë²„ Cì˜ ë°°ì¹˜ ë˜ëŠ” ì„œë²„ Bì˜ ì›Œì»¤ì—ì„œ ìˆ˜í–‰)
* **ë©´ì ‘ ê²°ê³¼ ëŒ€ì‹œë³´ë“œ** : PostgreSQLì˜ `pgvector`ë¥¼ í™œìš©í•˜ì—¬ ë¶„ì•¼ë³„ ì¶”ì´(ìœ ì‚¬ë„ ì ìˆ˜)ë¥¼ ê³„ì‚°í•˜ê³ , FastAPIê°€ ì´ë¥¼ ê·¸ë˜í”„ìš© ë°ì´í„°ë¡œ ê°€ê³µí•˜ì—¬ ì „ë‹¬í•©ë‹ˆë‹¤.
* **ë°°ì¹˜ í”„ë¡œê·¸ë¨** : `Celery Beat`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë§¤ì¼ ìƒˆë²½ ì „ì¼ ë©´ì ‘ ë‚´ìš©ì„ ìš”ì•½í•˜ê³ , íšŒì‚¬ ì •ë³´ ë° ì±„ìš© ì •ë³´ë¥¼ í¬ë¡¤ë§í•˜ì—¬ Oracle DBì— ì ì¬í•©ë‹ˆë‹¤.

---

### ğŸ’¡ ê¶Œì¥ í™˜ê²½ ì„¤ì • (Common)

1. **VRAM ê³µìœ ** : LLMì€ **Ollama**ë¥¼ í†µí•´ ë°±ê·¸ë¼ìš´ë“œì—ì„œ êµ¬ë™í•˜ì—¬ ì‹œìŠ¤í…œ RAMê³¼ VRAMì„ ìœ ë™ì ìœ¼ë¡œ ì‚¬ìš©í•˜ê²Œ í•˜ì‹­ì‹œì˜¤.
2. **ë°ì´í„°ë² ì´ìŠ¤ ë¶„ë¦¬** : Oracleì€ ì—”í„°í”„ë¼ì´ì¦ˆ ë°ì´í„°(íšŒì‚¬ ì •ë³´, íšŒì›)ìš©ìœ¼ë¡œ, PostgreSQLì€ AI ë¶„ì„ ë°ì´í„°(ë²¡í„°, ë¡œê·¸)ìš©ìœ¼ë¡œ ì´ì›í™”í•˜ì—¬ ì‚¬ìš©í•˜ì‹­ì‹œì˜¤.
3. **ë„¤íŠ¸ì›Œí¬** : ì„œë²„ ê°„ ë°ì´í„° ì „ì†¡(ìŒì„±/ì˜ìƒ)ëŸ‰ì´ ë§ìœ¼ë¯€ë¡œ 1Gbps ì´ìƒì˜ ë‚´ë¶€ë§ ì—°ê²°ì´ í•„ìˆ˜ì…ë‹ˆë‹¤.

## docker êµ¬ì„±

ë¶€í•˜ ë¶„ì‚° í´ëŸ¬ìŠ¤í„°í˜• êµ¬ì„±ì€ **ì‹¤ì‹œê°„ ëŒ€í™”(ì„œë²„ A)**ì™€ **ì •ë°€ ë¶„ì„ ë° ë°°ì¹˜(ì„œë²„ B)**ë¡œ GPU ë¶€í•˜ë¥¼ ë‚˜ëˆ„ì–´ ì „ì²´ ì‹œìŠ¤í…œì˜ ì²˜ë¦¬ëŸ‰ì„ ê·¹ëŒ€í™”í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤.

ëª¨ë“  ì„œë²„ëŠ” ë™ì¼í•œ `requirements.txt`ë¥¼ ê³µìœ í•˜ëŠ” íŒŒì´ì¬ í™˜ê²½ì„ ê¸°ë°˜ìœ¼ë¡œ í•˜ë©°, ê° ì„œë²„ì˜ IPì— ë§ì¶° ì„œë¡œë¥¼ ì°¸ì¡°í•˜ë„ë¡ ì„¤ì •í•©ë‹ˆë‹¤.

---

### 0. ê³µí†µ í™˜ê²½ ì„¤ì • (.env)

ëª¨ë“  ì„œë²„ì˜ í”„ë¡œì íŠ¸ ë£¨íŠ¸ í´ë”ì— ì•„ë˜ ë‚´ìš©ì„ ë‹´ì€ `.env` íŒŒì¼ì„ ìƒì„±í•˜ì„¸ìš”.

**Plaintext**

```
# Server IPs
IP_A=192.168.40.61
IP_B=192.168.40.62
IP_C=192.168.40.54

# DB Settings
POSTGRES_USER=admin
POSTGRES_PASSWORD=interview_pass
POSTGRES_DB=interview_db
ORACLE_PASSWORD=oracle_pass

# Redis & Celery
REDIS_URL=redis://192.168.40.61:6379/0
CELERY_BROKER_URL=redis://192.168.40.61:6379/0
CELERY_RESULT_BACKEND=redis://192.168.40.61:6379/0
```

---

### 1. ì„œë²„ A (192.168.40.61): ì‹¤ì‹œê°„ ëŒ€í™” ë° ì¸í„°í˜ì´ìŠ¤ ë…¸ë“œ

ì‚¬ìš©ì ì ‘ì†ì„ ì²˜ë¦¬í•˜ê³ , ì‹¤ì‹œê°„ ìŒì„± ì¸ì‹(STT)ê³¼ ëŒ€í™” ìƒì„±(LLM)ì— GPUë¥¼ ì§‘ì¤‘í•©ë‹ˆë‹¤.

**YAML**

```
# Server A: docker-compose.yml
version: '3.8'

services:
  # 1. ë©”ì‹œì§€ ë¸Œë¡œì»¤ (ì¤‘ì•™ ì§‘ì¤‘í˜•)
  redis:
    image: redis:7.2-alpine
    container_name: central_redis
    ports:
      - "6379:6379"
    restart: always

  # 2. ë©”ì¸ ì›¹ ì„œë²„ (FastAPI)
  web:
    build: .
    container_name: interview_api
    ports:
      - "8000:8000"
    env_file: .env
    depends_on:
      - redis

  # 3. ì‹¤ì‹œê°„ AI ì›Œì»¤ (STT, LLM ê¼¬ë¦¬ì§ˆë¬¸ ì „ë‹´)
  rt_worker:
    build: .
    container_name: worker_realtime
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]
    env_file: .env
    command: celery -A tasks worker -Q realtime_queue --concurrency=1 --loglevel=info

  # 4. LLM ì„œë²„ (Ollama í™œìš©)
  ollama:
    image: ollama/ollama
    container_name: ollama_server
    ports:
      - "11434:11434"
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]
```

---

### 2. ì„œë²„ B (192.168.40.62): ì‹œê° ë¶„ì„ ë° ë°°ì¹˜ ì‘ì—… ë…¸ë“œ

ì–¼êµ´/í‘œì • ì¸ì‹ê³¼ ì´ë ¥ì„œ ë¶„ì„, ê·¸ë¦¬ê³  ì£¼ê¸°ì ì¸ ë°ì´í„° ì ì¬(Batch)ì— GPUë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

**YAML**

```
# Server B: docker-compose.yml
version: '3.8'

services:
  # 1. ì •ë°€ ë¶„ì„ ì›Œì»¤ (ì–¼êµ´ì¸ì‹, ì´ë ¥ì„œ ì²¨ì‚­, ê²°ê³¼ ë¦¬í¬íŠ¸ ìƒì„±)
  analysis_worker:
    build: .
    container_name: worker_analysis
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]
    env_file: .env
    command: celery -A tasks worker -Q analysis_queue --concurrency=1 --loglevel=info

  # 2. ë°°ì¹˜ ìŠ¤ì¼€ì¤„ëŸ¬ (íšŒì‚¬/ì·¨ì—… ì •ë³´ ìˆ˜ì§‘, ì „ì¼ ë‚´ìš© ì •ë¦¬)
  celery_beat:
    build: .
    container_name: interview_beat
    env_file: .env
    command: celery -A tasks beat --loglevel=info

  # 3. ë°°ì¹˜ ì „ìš© ì›Œì»¤ (ë°ì´í„° ì ì¬ ì „ìš©)
  batch_worker:
    build: .
    container_name: worker_batch
    env_file: .env
    command: celery -A tasks worker -Q batch_queue --loglevel=info
```

---

### 3. ì„œë²„ C (192.168.40.54): ì¤‘ì•™ ë°ì´í„° ì„¼í„° ë…¸ë“œ

ëª¨ë“  ë°ì´í„°ë¥¼ ì €ì¥í•˜ê³  í†µê³„ë¥¼ ì²˜ë¦¬í•˜ëŠ” ê³ ì„±ëŠ¥ DB ë…¸ë“œì…ë‹ˆë‹¤.

**YAML**

```
# Server C: docker-compose.yml
version: '3.8'

services:
  # 1. ê´€ê³„í˜• ë° ë²¡í„° DB (PostgreSQL + pgvector)
  postgres:
    image: pgvector/pgvector:pg16
    container_name: vector_db
    ports:
      - "5432:5432"
    environment:
      POSTGRES_USER: ${POSTGRES_USER}
      POSTGRES_PASSWORD: ${POSTGRES_PASSWORD}
      POSTGRES_DB: ${POSTGRES_DB}
    volumes:
      - pg_data:/var/lib/postgresql/data
    restart: always

  # 2. ì—”í„°í”„ë¼ì´ì¦ˆ DB (Oracle XE)
  oracle:
    image: gvenzl/oracle-xe:latest
    container_name: enterprise_db
    ports:
      - "1521:1521"
    environment:
      ORACLE_PASSWORD: ${ORACLE_PASSWORD}
    volumes:
      - oracle_data:/opt/oracle/oradata
    restart: always

volumes:
  pg_data:
  oracle_data:
```

---

### 4. í•„ìˆ˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ (requirements.txt)

**Plaintext**

```
fastapi
uvicorn
celery
redis
sqlalchemy
psycopg2-binary
cx_Oracle
python-dotenv
# AI Models
faster-whisper
edge-tts
opencv-python
deepface
ollama
langchain
langchain-community
# File Processing
PyMuPDF
python-docx
# Analytics
pandas
matplotlib
```

---

### ğŸ’¡ êµ¬ì„± ìš”ì•½ ë° ìš´ì˜ íŒ

1. **ë„¤íŠ¸ì›Œí¬ íë¦„** : ì„œë²„ Aì˜ `FastAPI`ê°€ ìš”ì²­ì„ ë°›ìœ¼ë©´ `Redis`(.61)ë¥¼ í†µí•´ ì‘ì—…ì„ ë¶„ë°°í•©ë‹ˆë‹¤. ì‹¤ì‹œê°„ ìŒì„±/ëŒ€í™”ëŠ” ì„œë²„ Aê°€, ë¹„ì „/ì„œë¥˜ ë¶„ì„ì€ ì„œë²„ Bê°€ ê°€ë¡œì±„ì–´ ì²˜ë¦¬í•©ë‹ˆë‹¤. ìµœì¢… ë°ì´í„°ëŠ” ì„œë²„ Cë¡œ ëª¨ì…ë‹ˆë‹¤.
2. **GPU ì¶©ëŒ ë°©ì§€** : ê° ì›Œì»¤ì˜ `--concurrency=1` ì„¤ì •ì€ 6GB VRAMì—ì„œ ì—¬ëŸ¬ ëª¨ë¸ì´ ì—‰ì¼œ ì£½ëŠ” ê²ƒì„ ë°©ì§€í•©ë‹ˆë‹¤. ì‘ì—…ì„ í•˜ë‚˜ì”© ì°¨ë¡€ëŒ€ë¡œ ì™„ë²½í•˜ê²Œ ì²˜ë¦¬í•©ë‹ˆë‹¤.
3. **ë°°ì¹˜ ì‹œìŠ¤í…œ** : `celery_beat`ê°€ ì„œë²„ Bì—ì„œ ì‘ë™í•˜ë©°, ë§¤ì¼ ì •í•´ì§„ ì‹œê°„ì— í¬ë¡¤ëŸ¬ì™€ ìš”ì•½ í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•˜ì—¬ ì„œë²„ Cì˜ Oracle DBë¥¼ ì—…ë°ì´íŠ¸í•©ë‹ˆë‹¤.
4. **í™•ì¥ì„±** : ì¶”í›„ ì‚¬ìš©ìê°€ ëŠ˜ì–´ë‚˜ë©´ ì„œë²„ Aì™€ Bì˜ ì—­í• ì„ í•˜ëŠ” ì„œë²„ë§Œ ì¶”ê°€í•˜ì—¬ ë¦¬ìŠ¤íŠ¸ì— ë“±ë¡í•˜ë©´ ì¦‰ì‹œ ì„±ëŠ¥ì´ í™•ì¥ë©ë‹ˆë‹¤.

ì´ì œ ê° ì„œë²„ì˜ í´ë”ì— í•´ë‹¹ íŒŒì¼ì„ ë°°ì¹˜í•˜ê³  `docker-compose up -d` ëª…ë ¹ì–´ë¡œ ì„œë¹„ìŠ¤ë¥¼ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. **ì²« ì‹¤í–‰ ì‹œ Oracle DBì˜ ì´ˆê¸° ì„¤ì • ì‹œê°„ì´ ë‹¤ì†Œ ê±¸ë¦´ ìˆ˜ ìˆìœ¼ë‹ˆ ì°¸ê³ í•˜ì„¸ìš”.**

í˜¹ì‹œ **ì„œë²„ ê°„ íŒŒì¼(ìŒì„±/ì´ë ¥ì„œ)ì„ ê³µìœ í•˜ê¸° ìœ„í•œ ê³µìœ  ì €ì¥ì†Œ(NFS ë“±) ì„¤ì •**ë„ í•¨ê»˜ í•„ìš”í•˜ì‹ ê°€ìš”? Would you like me to ... ë„ì™€ë“œë¦´ê¹Œìš”?

# Dockerfile

ì´ì „ì— ì‘ì„±í•´ ë“œë¦° `docker-compose.yml` íŒŒì¼ì—ì„œ `build: .` ì´ë¼ëŠ” ì„¤ì •ì„ ë³´ì…¨ì„ ê²ë‹ˆë‹¤. ì´ ì„¤ì •ì€ í˜„ì¬ í´ë”ì— ìˆëŠ” `Dockerfile`ì„ ì½ì–´ì„œ **ìš°ë¦¬ ì‹œìŠ¤í…œì— í•„ìš”í•œ ëª¨ë“  ë¼ì´ë¸ŒëŸ¬ë¦¬(STT, í‘œì • ì¸ì‹, DB ì ‘ì† ë„êµ¬ ë“±)ê°€ ì„¤ì¹˜ëœ "ë‚˜ë§Œì˜ í™˜ê²½(Image)"**ì„ ë§Œë“¤ë¼ëŠ” ëœ»ì…ë‹ˆë‹¤.

íŠ¹íˆ **GTX 1660 SUPER(GPU)**ë¥¼ ì‚¬ìš©í•˜ê³ , **OpenCV(ì–¼êµ´ ì¸ì‹)**ì™€ **Oracle/PostgreSQL**ì— ì ‘ì†í•´ì•¼ í•˜ë¯€ë¡œ, ì¼ë°˜ì ì¸ íŒŒì´ì¬ ì´ë¯¸ì§€ê°€ ì•„ë‹Œ **GPU ì§€ì› ê¸°ëŠ¥ê³¼ ì‹œìŠ¤í…œ íŒ¨í‚¤ì§€ê°€ í¬í•¨ëœ Dockerfile**ì´ ê¼­ í•„ìš”í•©ë‹ˆë‹¤.

---

## 1. AI ëª¨ì˜ ë©´ì ‘ ì‹œìŠ¤í…œ í†µí•© Dockerfile

ì´ íŒŒì¼ í•˜ë‚˜ë¡œ ì„œë²„ Aì˜ ì›¹ ì„œë²„ì™€ ì„œë²„ Bì˜ AI ì›Œì»¤, ë°°ì¹˜ í”„ë¡œê·¸ë¨ ëª¨ë‘ë¥¼ êµ¬ë™í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.

**Dockerfile**

```
# 1. GPU ì§€ì› ë° íŒŒì´ì¬ í™˜ê²½ì„ ìœ„í•œ NVIDIA CUDA ë² ì´ìŠ¤ ì´ë¯¸ì§€ ì‚¬ìš©
# ìœˆë„ìš° Docker Desktop(WSL2) í™˜ê²½ì—ì„œ GPUë¥¼ ì›í™œíˆ ì“°ê¸° ìœ„í•´ ìµœì í™”ëœ ë²„ì „ì…ë‹ˆë‹¤.
FROM nvidia/cuda:12.1.0-base-ubuntu22.04

# 2. íŒŒì´ì¬ ë° í•„ìˆ˜ ì‹œìŠ¤í…œ íŒ¨í‚¤ì§€ ì„¤ì¹˜
# OpenCV(ì–¼êµ´ì¸ì‹), PostgreSQL, Oracle í´ë¼ì´ì–¸íŠ¸ ì„¤ì¹˜ë¥¼ ìœ„í•œ ì„¤ì •ì…ë‹ˆë‹¤.
ENV DEBIAN_FRONTEND=noninteractive
RUN apt-get update && apt-get install -y \
    python3.10 \
    python3-pip \
    libgl1-mesa-glx \
    libglib2.0-0 \
    libpq-dev \
    libaio1 \
    wget \
    unzip \
    && rm -rf /var/lib/apt/lists/*

# 3. ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •
WORKDIR /app

# 4. íŒŒì´ì¬ íŒ¨í‚¤ì§€ ì„¤ì¹˜
# ì´ì „ì— ì¶”ì²œë“œë¦° requirements.txt íŒŒì¼ì„ ë³µì‚¬í•˜ì—¬ ì„¤ì¹˜í•©ë‹ˆë‹¤.
COPY requirements.txt .
RUN pip3 install --no-cache-dir -r requirements.txt

# 5. ì†ŒìŠ¤ ì½”ë“œ ë³µì‚¬
COPY . .

# 6. í™˜ê²½ ë³€ìˆ˜ ì„¤ì •
# íŒŒì´ì¬ ì¶œë ¥ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸í•˜ê¸° ìœ„í•œ ì„¤ì •ì…ë‹ˆë‹¤.
ENV PYTHONUNBUFFERED=1

# 7. ì‹¤í–‰ (docker-composeì˜ commandì—ì„œ ë®ì–´ì“°ë¯€ë¡œ ì—¬ê¸°ì„œëŠ” ê¸°ë³¸ê°’ë§Œ ì„¤ì •)
CMD ["python3", "main.py"]
```

---

## 2. ì™œ ì´ Dockerfileì´ ì¤‘ìš”í•œê°€ìš”?

* **GPU ê°€ì† (NVIDIA CUDA)** : `nvidia/cuda` ì´ë¯¸ì§€ë¥¼ ê¸°ë°˜ìœ¼ë¡œ í•´ì•¼ë§Œ ì›Œì»¤ ì„œë²„ì—ì„œ **ì–¼êµ´ ì¸ì‹(DeepFace)**ì´ë‚˜ **ìŒì„± ì¸ì‹(Faster-Whisper)** ì‹œ 1660 SUPERì˜ GPU íŒŒì›Œë¥¼ ì œëŒ€ë¡œ ëŒì–´ë‹¤ ì“¸ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
* **ì‹œê° ì§€ëŠ¥ ì§€ì› (libgl1)** : OpenCVë‚˜ ì–¼êµ´ ì¸ì‹ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ìœˆë„ìš° í˜¸ìŠ¤íŠ¸ì™€ ë‹¬ë¦¬ ë¦¬ëˆ…ìŠ¤ ì»¨í…Œì´ë„ˆ ë‚´ë¶€ì—ì„œëŠ” íŠ¹ì • ê·¸ë˜í”½ ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ì—†ìœ¼ë©´ ì—ëŸ¬ê°€ ë‚©ë‹ˆë‹¤. ì´ë¥¼ ë¯¸ì—°ì— ë°©ì§€í•˜ê¸° ìœ„í•´ `libgl1-mesa-glx`ë¥¼ í¬í•¨í–ˆìŠµë‹ˆë‹¤.
* **ë³µí•© DB ì ‘ì†** : Oracleê³¼ PostgreSQLì„ ë™ì‹œì— ì‚¬ìš©í•˜ì‹œë¯€ë¡œ, ê° DB ë“œë¼ì´ë²„ê°€ ì •ìƒ ì‘ë™í•˜ê¸° ìœ„í•œ ì‹œìŠ¤í…œ ë¼ì´ë¸ŒëŸ¬ë¦¬(`libpq-dev`, `libaio1`)ë¥¼ ë¯¸ë¦¬ ì‹¬ì–´ë‘ì—ˆìŠµë‹ˆë‹¤.

---

## 3. ìœˆë„ìš° í™˜ê²½ì—ì„œ ì‹¤í–‰ ì‹œ ì£¼ì˜ì‚¬í•­

1. **íŒŒì¼ëª…** : íŒŒì¼ ì´ë¦„ì€ ë°˜ë“œì‹œ í™•ì¥ì ì—†ì´ `Dockerfile`ë¡œ ì €ì¥í•´ì•¼ í•©ë‹ˆë‹¤.
2. **ìœ„ì¹˜** : `docker-compose.yml` íŒŒì¼ê³¼ ê°™ì€ í´ë”ì— ìˆì–´ì•¼ í•©ë‹ˆë‹¤.
3. **ë¹Œë“œ ëª…ë ¹ì–´** : ëª¨ë“  íŒŒì¼ì„ ì¤€ë¹„í•œ í›„, ìœˆë„ìš° íŒŒì›Œì‰˜(PowerShell)ì—ì„œ ì•„ë˜ ëª…ë ¹ì–´ë¥¼ ì…ë ¥í•˜ë©´ ë¹Œë“œê°€ ì‹œì‘ë©ë‹ˆë‹¤.
   **PowerShell**

```
   docker-compose build
```

## ì„œë²„C Dockerfile ì„¤ì •

ì„œë²„ CëŠ” ì‹œìŠ¤í…œì˜ **ë°ì´í„° ì‹¬ì¥ë¶€**ì…ë‹ˆë‹¤. ì—¬ê¸°ì—ëŠ” **PostgreSQL(pgvector)**ê³¼ **Oracle XE** ê°™ì€ ë°ì´í„°ë² ì´ìŠ¤ê°€ ì˜¬ë¼ê°€ë©°, ì¶”ê°€ë¡œ **ë°°ì¹˜(Batch) í”„ë¡œê·¸ë¨**ì´ ëŒì•„ê°€ê²Œ ë©ë‹ˆë‹¤.

ì¤‘ìš”í•œ ì ì€ **ë°ì´í„°ë² ì´ìŠ¤(DB)** ìì²´ëŠ” ì´ë¯¸ ì˜ ë§Œë“¤ì–´ì§„ **ê³µì‹ ì´ë¯¸ì§€**ë¥¼ ê°€ì ¸ë‹¤ ì“°ê¸° ë•Œë¬¸ì— ë³„ë„ì˜ Dockerfileì´ í•„ìš” ì—†ì§€ë§Œ, **ë°°ì¹˜ í”„ë¡œê·¸ë¨**ì€ ìš°ë¦¬ê°€ ì§  ì½”ë“œë¥¼ ì‹¤í–‰í•´ì•¼ í•˜ë¯€ë¡œ **ì „ìš© Dockerfile**ì´ í•„ìš”í•©ë‹ˆë‹¤.

---

### 1. ì„œë²„ Cì˜ ì—­í•  êµ¬ë¶„

* **DB ì„œë¹„ìŠ¤ (PostgreSQL, Oracle)** : `docker-compose.yml`ì—ì„œ ê³µì‹ ì´ë¯¸ì§€ë¥¼ ì„¤ì •í•˜ì—¬ ì¦‰ì‹œ ì‹¤í–‰í•©ë‹ˆë‹¤. (Dockerfile ë¶ˆí•„ìš”)
* **ë°°ì¹˜ ì„œë¹„ìŠ¤ (Batch App)** : íšŒì‚¬ ì •ë³´ í¬ë¡¤ë§, ì·¨ì—… ì •ë³´ ì ì¬, ì „ì¼ ë©´ì ‘ ìš”ì•½ ë“±ì„ ìˆ˜í–‰í•˜ëŠ” íŒŒì´ì¬ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ê¸° ìœ„í•œ **ì»¤ìŠ¤í…€ Dockerfile**ì´ í•„ìš”í•©ë‹ˆë‹¤.

---

### 2. ì„œë²„ C ì „ìš© Batch Dockerfile (Dockerfile.batch)

ì„œë²„ CëŠ” DB ì—°ì‚°ì— RAM(32GB)ì„ ë§ì´ ì¨ì•¼ í•˜ë¯€ë¡œ, ë°°ì¹˜ìš© Dockerfileì€ ì„œë²„ A, Bë³´ë‹¤ ì¡°ê¸ˆ ë” ê°€ë³ê²Œ êµ¬ì„±í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ Oracleê³¼ PostgreSQL ì ‘ì† ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” ë°˜ë“œì‹œ í¬í•¨ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.

**Dockerfile**

```
# 1. íŒŒì´ì¬ 3.10 ìŠ¬ë¦¼ ë² ì´ìŠ¤ ì´ë¯¸ì§€ (ì„œë²„ CëŠ” DB ë¶€í•˜ë¥¼ ê³ ë ¤í•´ ê°€ë²¼ìš´ ì´ë¯¸ì§€ ê¶Œì¥)
FROM python:3.10-slim

# 2. í•„ìˆ˜ ì‹œìŠ¤í…œ íŒ¨í‚¤ì§€ ì„¤ì¹˜
# Oracleìš© libaio1ê³¼ PostgreSQLìš© libpq-devê°€ í•µì‹¬ì…ë‹ˆë‹¤.
RUN apt-get update && apt-get install -y \
    libpq-dev \
    libaio1 \
    wget \
    unzip \
    build-essential \
    && rm -rf /var/lib/apt/lists/*

# 3. Oracle Instant Client ì„¤ì¹˜ (Oracle DB ì ‘ì†ì— í•„ìˆ˜)
WORKDIR /opt/oracle
RUN wget https://download.oracle.com/otn_software/linux/instantclient/instantclient-basic-linuxx64.el9.zip && \
    unzip *.zip && rm -f *.zip
ENV LD_LIBRARY_PATH=/opt/oracle/instantclient_19_25:$LD_LIBRARY_PATH

# 4. ì‘ì—… ë””ë ‰í† ë¦¬ ì„¤ì •
WORKDIR /app

# 5. íŒŒì´ì¬ íŒ¨í‚¤ì§€ ì„¤ì¹˜
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# 6. ì†ŒìŠ¤ ì½”ë“œ ë³µì‚¬
COPY . .

# 7. ì‹¤í–‰ í™˜ê²½ ì„¤ì •
ENV PYTHONUNBUFFERED=1

# ë°°ì¹˜ í”„ë¡œê·¸ë¨ ì‹¤í–‰ íŒŒì¼ ì§€ì • (ì˜ˆ: batch_main.py)
CMD ["python", "batch_main.py"]
```

---

### 3. ì„œë²„ Cì˜ `docker-compose.yml` ìµœì¢… êµ¬ì¡°

ì„œë²„ Cì—ì„œëŠ” ìœ„ì—ì„œ ë§Œë“  `Dockerfile.batch`ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°°ì¹˜ ì„œë¹„ìŠ¤ë¥¼ ë„ì›ë‹ˆë‹¤.

**YAML**

```
# version: '3.8' 

services:
  # [DB 1] ë²¡í„° ê²€ìƒ‰ìš© PostgreSQL + pgvector
  postgres:
    image: pgvector/pgvector:pg16
    container_name: vector_db
    ports:
      - "5432:5432"
    env_file: ../.env
    volumes:
      - pg_data:/var/lib/postgresql/data
    restart: always

  # [DB 2] ì—”í„°í”„ë¼ì´ì¦ˆìš© Oracle
  oracle:
    image: gvenzl/oracle-xe:latest
    container_name: enterprise_db
    ports:
      - "1521:1521"
    env_file: ../.env
    volumes:
      - oracle_data:/opt/oracle/oradata
    restart: always

  # [AI] ì„ë² ë”© ì „ìš© Ollama
  embedding_server:
    image: ollama/ollama
    container_name: ollama_embedding
    environment:
      - OLLAMA_HOST=0.0.0.0      # ëª¨ë“  ë„¤íŠ¸ì›Œí¬ ì¸í„°í˜ì´ìŠ¤ì—ì„œ ì ‘ì† í—ˆìš©
      - OLLAMA_ORIGINS=* # CORS í—ˆìš© (ë¸Œë¼ìš°ì €/n8n ë“± ì ‘ì† ì‹œ í•„ìš”)
      - OLLAMA_KEEP_ALIVE=24h # ì„ë² ë”© ëª¨ë¸ ìƒì£¼
    ports:
      - "11435:11434" # ì™¸ë¶€ 11435 -> ì»¨í…Œì´ë„ˆ 11434
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]
    restart: always

  # [Batch] ì£¼ê¸°ì  ë°ì´í„° ì²˜ë¦¬ í”„ë¡œê·¸ë¨
  batch_app:
    build:
      context: .
      dockerfile: Dockerfile.batch
    container_name: interview_batch
    env_file: ../.env
    depends_on:
      - postgres
      - oracle
      - embedding_server
    restart: on-failure
    volumes:
      - Z:\:/shared_data
      - ../../../src/Ethos:/app/Ethos

  # [Storage] ì˜¤ë¸Œì íŠ¸ ìŠ¤í† ë¦¬ì§€ MinIO
  minio:
    image: minio/minio:latest
    container_name: minio_server
    ports:
      - "9000:9000"       # API í¬íŠ¸
      - "9001:9001"       # ì½˜ì†”(GUI) í¬íŠ¸
    env_file: ../.env
    volumes:
      - minio_data:/data
    command: server /data --console-address ":9001"
    restart: always

volumes:
  pg_data:
  oracle_data:
  minio_data:

```

---

### 4. ìœˆë„ìš° í™˜ê²½ì—ì„œì˜ ë¹Œë“œ ë° ì‹¤í–‰ íŒ

1. **íŒŒì¼ëª… êµ¬ë¶„** : ì„œë²„ A, Bìš© Dockerfileê³¼ ì„œë²„ Cì˜ ë°°ì¹˜ìš© Dockerfileì„ êµ¬ë¶„í•´ì„œ ì €ì¥í•˜ì„¸ìš”. (ì˜ˆ: `Dockerfile.ai`, `Dockerfile.batch`)
2. **Oracle ì´ˆê¸° ê°€ë™** : Oracle XE ì´ë¯¸ì§€ëŠ” ì²˜ìŒ ì‹¤í–‰ë  ë•Œ ë°ì´í„°ë² ì´ìŠ¤ êµ¬ì¡°ë¥¼ ë§Œë“œëŠë¼ ì‹œê°„ì´ ë‹¤ì†Œ ê±¸ë¦½ë‹ˆë‹¤. (ìµœëŒ€ 3~5ë¶„) ì´ë•Œ ë°°ì¹˜ í”„ë¡œê·¸ë¨ì´ ì ‘ì†ì„ ì‹œë„í•˜ë©´ ì—ëŸ¬ê°€ ë‚  ìˆ˜ ìˆìœ¼ë‹ˆ, íŒŒì´ì¬ ì½”ë“œ ë‚´ì—ì„œ **ì¬ì‹œë„(Retry) ë¡œì§**ì„ ë„£ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.
3. **ë©”ëª¨ë¦¬ ë°°ë¶„** : 32GB RAM ì¤‘ 8~12GBëŠ” Oracleì—, 4~8GBëŠ” PostgreSQLì— í• ë‹¹ë˜ë„ë¡ ì„¤ì •í•˜ë©´ ë°°ì¹˜ í”„ë¡œê·¸ë¨ì´ ì•ˆì •ì ìœ¼ë¡œ ë™ì‘í•©ë‹ˆë‹¤.
